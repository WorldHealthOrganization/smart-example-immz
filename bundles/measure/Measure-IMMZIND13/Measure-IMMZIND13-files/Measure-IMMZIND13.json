{
  "resourceType": "Measure",
  "id": "IMMZIND13",
  "meta": {
    "profile": [ "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cv-measure-cqfm", "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/computable-measure-cqfm" ]
  },
  "contained": [ {
    "resourceType": "Library",
    "id": "effective-data-requirements",
    "extension": [ {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-directReferenceCode",
      "valueCoding": {
        "system": "http://hl7.org/fhir/administrative-gender",
        "code": "male",
        "display": "Males"
      }
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-directReferenceCode",
      "valueCoding": {
        "system": "http://hl7.org/fhir/administrative-gender",
        "code": "female",
        "display": "Females"
      }
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-directReferenceCode",
      "valueCoding": {
        "system": "http://hl7.org/fhir/administrative-gender",
        "code": "other",
        "display": "Other/NA"
      }
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-directReferenceCode",
      "valueCoding": {
        "system": "http://ohie.org/CodeSystem/iso-8601-derived-periods",
        "code": "P0Y--P1Y",
        "display": "< 1 year"
      }
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-directReferenceCode",
      "valueCoding": {
        "system": "http://ohie.org/CodeSystem/iso-8601-derived-periods",
        "code": "P1Y--P2Y",
        "display": "1 year"
      }
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-directReferenceCode",
      "valueCoding": {
        "system": "http://ohie.org/CodeSystem/iso-8601-derived-periods",
        "code": "P2Y--P9999Y",
        "display": "> 2 years"
      }
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZCommon"
      }, {
        "url": "name",
        "valueString": "Doses Administered to Patient"
      }, {
        "url": "statement",
        "valueString": "/**\n * @dataElement All Doses Administered to Patient to patient ordered newest to oldest\n */\ndefine \"Doses Administered to Patient\":\n  [Immunization] I\n    where I.status = 'completed'\n    sort by date from (occurrence as FHIR.dateTime) desc"
      }, {
        "url": "displaySequence",
        "valueInteger": 0
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZD2DTMeaslesLogic"
      }, {
        "url": "name",
        "valueString": "MCV Doses Administered to Patient"
      }, {
        "url": "statement",
        "valueString": "/**\n * @dataElement MCV containing Doses Administered to Patient\n */\ndefine \"MCV Doses Administered to Patient\":\n  IMMZCom.\"Doses Administered to Patient\" I\n  where\n    I.vaccineCode in IMMZc.\"MCV Vaccine\""
      }, {
        "url": "displaySequence",
        "valueInteger": 1
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZD2DTMeaslesLogic"
      }, {
        "url": "name",
        "valueString": "First MCV Dose Administered to Patient"
      }, {
        "url": "statement",
        "valueString": "/*\ndefine \"Needs Zero MCV Dose\":\n\t\"No MCV Doses Administered to Patient\" \n\t  and (\n\t\t\tif \"High Transmission Setting\" \n\t\t\tthen IMMZCom.\"Current Patient Age In Months\" between 6 and 9 \n\t\t\telse IMMZCom.\"Current Patient Age In Months\" between 6 and 12\n\t\t)\n\t\tand IMMZCom.\"Date of Latest Live Attenuated Vaccine\" +4 weeks <= Now()\n\t\tand \n\t\t\t(\n\t\t\t\t(\n\t\t\t\t\tIMMZCom.\"HIV Status\" in IMMZc.\"HIV status - HIV positive Choices\" \n\t\t\t\t\t  and (\n\t\t\t\t\t    not(IMMZCom.\"Patient is receiving HAART\")\n\t\t\t\t\t\t\tor \"Immune reconstitution was achieved\"\n\t\t\t\t\t\t)\n\t\t\t\t)\n\t\t\t\tor \"Individual is known to be HIV-infected or exposed\"\n\t\t\t)\n\ndefine \"Needs Supplementary MCV Dose\":\n\tIMMZCom.\"HIV Status\" in IMMZc.\"HIV status - HIV positive Choices\" \n\tand IMMZCom.\"Current Patient Age In Years\" < 15\n\tand IMMZCom.\"Patient is receiving HAART\"\n\tand \"Immune reconstitution was achieved\" \n\tand \"Supplementary MCV Dose Administered to Patient\" is null\n\tand IMMZCom.\"Date of Latest Live Attenuated Vaccine\" +4 weeks <= Now()\n*/\n\n/**\n * @dataElement Zero MCV dose given to Patient\n */\n//define \"Zero MCV Dose Administered to Patient\":\n//\tLast(\"MCV Doses Administered to Patient\" I where I.occurrence between Patient.birthDate + 6 months and Patient.birthDate + 9 months)\n\n/**\n * @dataElement Date Zero MCV dose administered\n */\n//define \"Date Zero MCV Dose Administered to Patient\":\n//  date from (\"Zero MCV Dose Administered to Patient\".occurrence as FHIR.dateTime)\n\n/**\n * @dataElement First MCV dose given to Patient\n */\ndefine \"First MCV Dose Administered to Patient\":\n\tif \"High Transmission Setting\"\n\tthen Last(\"MCV Doses Administered to Patient\" I where I.occurrence after Patient.birthDate + 9 months)\n\telse Last(\"MCV Doses Administered to Patient\" I where I.occurrence after Patient.birthDate + 12 months)"
      }, {
        "url": "displaySequence",
        "valueInteger": 2
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZD2DTMeaslesLogic"
      }, {
        "url": "name",
        "valueString": "Date First MCV Dose Administered to Patient"
      }, {
        "url": "statement",
        "valueString": "/**\n * @dataElement Date first MCV dose administered\n */\ndefine \"Date First MCV Dose Administered to Patient\":\n  date from (\"First MCV Dose Administered to Patient\".occurrence as FHIR.dateTime)"
      }, {
        "url": "displaySequence",
        "valueInteger": 3
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZD2DTMeaslesLogic"
      }, {
        "url": "name",
        "valueString": "Second MCV Dose Administered to Patient"
      }, {
        "url": "statement",
        "valueString": "/**\n * @dataElement \"Second MCV Dose Administered to Patient\"\n * only valid if 4 weeks after first dose\n */\ndefine \"Second MCV Dose Administered to Patient\":\n  Last(\"MCV Doses Administered to Patient\" I \n\t\twhere I.occurrence after \"Date First MCV Dose Administered to Patient\" + 4 weeks \n\t\t\tand I.occurrence after Patient.birthDate + 15 months)"
      }, {
        "url": "displaySequence",
        "valueInteger": 4
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZINDMeasles"
      }, {
        "url": "name",
        "valueString": "Initial Population 13"
      }, {
        "url": "statement",
        "valueString": "/*\n * Target population for second dose: Any one over 15 months\n */ \ndefine \"Initial Population 13\":\n\tMeasles.\"Second MCV Dose Administered to Patient\" I where IMMZCom.ToDate(I.occurrence) during \"Measurement Period\""
      }, {
        "url": "displaySequence",
        "valueInteger": 5
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZINDMeasles"
      }, {
        "url": "name",
        "valueString": "Measure Population 13"
      }, {
        "url": "statement",
        "valueString": "/*\n * Numerator for second dose: Anyone having received the first dose\n */\ndefine \"Measure Population 13\":\n\t\"Initial Population 13\""
      }, {
        "url": "displaySequence",
        "valueInteger": 6
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZIndicatorCommon"
      }, {
        "url": "name",
        "valueString": "By Administrative Gender Stratifier"
      }, {
        "url": "statement",
        "valueString": "/**\n * By Administrative Gender of Patient Stratifier\n */\ndefine \"By Administrative Gender Stratifier\":\n    case \n        when Patient.gender = 'male' then \"Males\"\n        when Patient.gender = 'female' then \"Females\"\n        else \"Other\"\n    end"
      }, {
        "url": "displaySequence",
        "valueInteger": 7
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZIndicatorCommon"
      }, {
        "url": "name",
        "valueString": "Toddler By Age Stratifier"
      }, {
        "url": "statement",
        "valueString": "/** \n * Toddler By Age Stratifiers\n */\ndefine \"Toddler By Age Stratifier\":\n    case \n        when AgeInYearsAt(start of \"Measurement Period\") < 1 then \"P0Y--P1Y\"\n        when AgeInYearsAt(start of \"Measurement Period\") < 2 then \"P1Y--P2Y\"\n        when AgeInYearsAt(start of \"Measurement Period\") >= 2 then \"P2Y--P9999Y\"\n        else null\n    end"
      }, {
        "url": "displaySequence",
        "valueInteger": 8
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZIndicatorCommon"
      }, {
        "url": "name",
        "valueString": "By Geographic Region Stratifier"
      }, {
        "url": "statement",
        "valueString": "/**\n * By Administrative Gender of Patient Stratifier\n */\ndefine \"By Geographic Region Stratifier\":\n    First(Patient.address A where A.use in { 'home' }).state"
      }, {
        "url": "displaySequence",
        "valueInteger": 9
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZINDMeasles"
      }, {
        "url": "name",
        "valueString": "Stratification"
      }, {
        "url": "statement",
        "valueString": "/*\n * Combined stratifiers\n */\ndefine \"Stratification\":\n\t\tIMMZIndCom.\"By Administrative Gender Stratifier\".code + ':' + IMMZIndCom.\"Toddler By Age Stratifier\".code + ':' + IMMZIndCom.\"By Geographic Region Stratifier\""
      }, {
        "url": "displaySequence",
        "valueInteger": 10
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "FHIRHelpers"
      }, {
        "url": "name",
        "valueString": "ToString"
      }, {
        "url": "statement",
        "valueString": "define function ToString(value ImmunizationStatus): value.value"
      }, {
        "url": "displaySequence",
        "valueInteger": 11
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "FHIRHelpers"
      }, {
        "url": "name",
        "valueString": "ToDateTime"
      }, {
        "url": "statement",
        "valueString": "define function ToDateTime(value dateTime): value.value"
      }, {
        "url": "displaySequence",
        "valueInteger": 12
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "FHIRHelpers"
      }, {
        "url": "name",
        "valueString": "ToConcept"
      }, {
        "url": "statement",
        "valueString": "define function ToConcept(concept FHIR.CodeableConcept):\n    if concept is null then\n        null\n    else\n        System.Concept {\n            codes: concept.coding C return ToCode(C),\n            display: concept.text.value\n        }"
      }, {
        "url": "displaySequence",
        "valueInteger": 13
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "FHIRHelpers"
      }, {
        "url": "name",
        "valueString": "ToDate"
      }, {
        "url": "statement",
        "valueString": "define function ToDate(value date): value.value"
      }, {
        "url": "displaySequence",
        "valueInteger": 14
      } ]
    }, {
      "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-logicDefinition",
      "extension": [ {
        "url": "libraryName",
        "valueString": "IMMZCommon"
      }, {
        "url": "name",
        "valueString": "ToDate"
      }, {
        "url": "statement",
        "valueString": "/**\n * @description Takes the date choice of a date/string choice (for Immunization date)\n */\ndefine function ToDate(choice Choice<FHIR.date, FHIR.string>):\n  case\n\t  when choice is FHIR.date then\n    \tchoice as FHIR.date\n\t\telse\n      Message(null as FHIR.date, true, '1', 'Error', 'Cannot compute a date from a String value')\n\tend"
      }, {
        "url": "displaySequence",
        "valueInteger": 15
      } ]
    } ],
    "name": "EffectiveDataRequirements",
    "status": "active",
    "type": {
      "coding": [ {
        "system": "http://terminology.hl7.org/CodeSystem/library-type",
        "code": "module-definition"
      } ]
    },
    "relatedArtifact": [ {
      "type": "depends-on",
      "display": "Library Measles",
      "resource": "http://smart.who.int/immunizations-measles/Library/IMMZD2DTMeaslesLogic"
    }, {
      "type": "depends-on",
      "display": "Library IMMZCom",
      "resource": "http://smart.who.int/immunizations-measles/Library/IMMZCommon"
    }, {
      "type": "depends-on",
      "display": "Library FHIRHelpers",
      "resource": "http://smart.who.int/immunizations-measles/Library/FHIRHelpers|4.0.1"
    }, {
      "type": "depends-on",
      "display": "Library IMMZc",
      "resource": "http://smart.who.int/immunizations-measles/Library/IMMZConcepts"
    }, {
      "type": "depends-on",
      "display": "Library IMMZIndCom",
      "resource": "http://smart.who.int/immunizations-measles/Library/IMMZIndicatorCommon"
    }, {
      "type": "depends-on",
      "display": "Code system Administrative Gender Codes",
      "resource": "http://hl7.org/fhir/administrative-gender"
    }, {
      "type": "depends-on",
      "display": "Code system ISO-8601-Derived Periods",
      "resource": "http://ohie.org/CodeSystem/iso-8601-derived-periods"
    }, {
      "type": "depends-on",
      "display": "Value set MCV Vaccine",
      "resource": "http://smart.who.int/immunizations-measles/ValueSet/IMMZ.Z.DE9"
    } ],
    "parameter": [ {
      "name": "Measurement Period",
      "use": "in",
      "min": 0,
      "max": "1",
      "type": "Period"
    }, {
      "name": "Measure Population 13",
      "use": "out",
      "min": 0,
      "max": "1",
      "type": "Immunization"
    }, {
      "name": "Stratification",
      "use": "out",
      "min": 0,
      "max": "1",
      "type": "string"
    }, {
      "name": "Initial Population 13",
      "use": "out",
      "min": 0,
      "max": "1",
      "type": "Immunization"
    } ],
    "dataRequirement": [ {
      "type": "Immunization",
      "profile": [ "http://hl7.org/fhir/StructureDefinition/Immunization" ],
      "mustSupport": [ "status", "vaccineCode", "occurrence" ]
    }, {
      "type": "Patient",
      "profile": [ "http://hl7.org/fhir/StructureDefinition/Patient" ],
      "mustSupport": [ "use" ]
    } ]
  } ],
  "extension": [ {
    "id": "effective-data-requirements",
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-effectiveDataRequirements",
    "valueReference": {
      "reference": "#effective-data-requirements"
    }
  }, {
    "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-softwaresystem",
    "valueReference": {
      "reference": "Device/cqf-tooling"
    }
  } ],
  "url": "http://smart.who.int/immunizations-measles/Measure/IMMZIND13",
  "version": "0.2.0",
  "name": "IMMZIND13",
  "title": "Immunization coverage for Measles and rubella containing vaccine, 2nd dose",
  "status": "draft",
  "experimental": false,
  "date": "2024-04-25",
  "publisher": "World Health Organization (WHO)",
  "description": "The percentage in the target population who have received second dose of measles and rubella vaccine during reporting period",
  "library": [ "http://smart.who.int/immunizations-measles/Library/IMMZINDMeasles" ],
  "scoring": {
    "coding": [ {
      "system": "http://terminology.hl7.org/CodeSystem/measure-scoring",
      "code": "continuous-variable",
      "display": "Continuous Variable"
    } ]
  },
  "group": [ {
    "population": [ {
      "id": "IMMZ.IND.13.IP",
      "extension": [ {
        "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-populationBasis",
        "valueCode": "boolean"
      } ],
      "code": {
        "coding": [ {
          "system": "http://terminology.hl7.org/CodeSystem/measure-population",
          "code": "initial-population",
          "display": "Initial Population"
        } ]
      },
      "description": "Initial Population",
      "criteria": {
        "language": "text/cql",
        "expression": "Initial Population 13"
      }
    }, {
      "id": "IMMZ.IND.13.MP",
      "extension": [ {
        "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-populationBasis",
        "valueCode": "boolean"
      } ],
      "code": {
        "coding": [ {
          "system": "http://terminology.hl7.org/CodeSystem/measure-population",
          "code": "measure-population",
          "display": "Measure Population"
        } ]
      },
      "description": "Measure Population",
      "criteria": {
        "language": "text/cql",
        "expression": "Measure Population 13"
      }
    }, {
      "id": "IMMZ.IND.13.MO",
      "extension": [ {
        "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-criteriaReference",
        "valueString": "measure-population"
      }, {
        "url": "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/cqfm-aggregateMethod",
        "valueCode": "count"
      } ],
      "code": {
        "coding": [ {
          "system": "http://terminology.hl7.org/CodeSystem/measure-population",
          "code": "measure-observation"
        } ]
      },
      "description": "Measure Observation",
      "criteria": {
        "language": "text/cql",
        "expression": "Measure Observation 13"
      }
    } ],
    "stratifier": [ {
      "id": "IMMZ.IND.13.S",
      "criteria": {
        "language": "text/cql",
        "expression": "Stratification"
      }
    } ]
  } ]
}